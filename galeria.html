<!-- galeria.html corrigido -->
<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<title>Galeria</title>
<style>
body{margin:0;font-family:sans-serif;background:#000;color:#fff;}
.data-titulo{font-size:18px;font-weight:bold;margin:20px 0 10px;}
.grid{display:grid;grid-template-columns:repeat(3,1fr);gap:6px;}
.grid img{width:100%;border-radius:6px;object-fit:cover;}
</style>
</head>
<body>

<div id="galeria"></div>

<script>
// ======================
// Normalize date
// ======================
function normalizeDate(val){
  if(!val) return null;
  return val.split("T")[0];
}

// ======================
// Formatar igual pesos.js
// ======================
function formatarDataBR(iso) {
  const meses = ["jan","fev","mar","abr","mai","jun","jul","ago","set","out","nov","dez"];
  const d = new Date(iso + "T00:00:00");
  if (isNaN(d)) return iso;
  const dia = String(d.getDate()).padStart(2,"0");
  const mes = meses[d.getMonth()];
  const ano = d.getFullYear();
  return `${dia} ${mes} ${ano}`;
}

// ======================
// Simulação de dados (troque pelo supabase no seu arquivo real)
// ======================
const dados = [
  { data_foto: "2025-11-01", url: "https://via.placeholder.com/300" },
  { data_foto: "2025-11-01", url: "https://via.placeholder.com/310" },
  { data_foto: "2025-11-02", url: "https://via.placeholder.com/320" }
];

// ======================
// Render
// ======================
function renderGaleria(lista){
  const area = document.getElementById("galeria");
  area.innerHTML = "";

  const grupos = {};

  lista.forEach(item=>{
    const data = normalizeDate(item.data_foto);
    if(!grupos[data]) grupos[data] = [];
    grupos[data].push(item);
  });

  const dias = Object.keys(grupos).sort().reverse();

  dias.forEach(key=>{
    area.innerHTML += `
      <div class="data-titulo">${formatarDataBR(key)}</div>
      <div class="grid" id="grid-${key}"></div>
    `;
    const grid = document.getElementById(`grid-${key}`);
    grupos[key].forEach(f=>{
      grid.innerHTML += `<img src="${f.url}">`;
    });
  });
}

renderGaleria(dados);
</script>

</body>
</html>
